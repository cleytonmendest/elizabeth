{%- comment -%}
  Seção reutilizável de Posts do Blog
  Pode ser usada em qualquer página (home, página de conteúdo, etc.)
{%- endcomment -%}

{%- liquid
  assign blog_handle = section.settings.blog | default: 'news'
  assign blog = blogs[blog_handle]
  assign posts_to_show = section.settings.posts_to_show | default: 3
  assign show_excerpt = section.settings.show_excerpt
  assign show_author = section.settings.show_author
  assign show_tags = section.settings.show_tags
  assign show_button = section.settings.show_button
-%}

<section class="blog-posts-section py-16 md:py-20" style="background-color: {{ section.settings.background_color }};">
  <div class="container mx-auto px-4 md:px-6 lg:px-8">

    {%- comment -%} Header da Seção {%- endcomment -%}
    <div class="text-center mb-12">
      {% if section.settings.heading != blank %}
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
          {{ section.settings.heading }}
        </h2>
      {% endif %}

      {% if section.settings.subheading != blank %}
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          {{ section.settings.subheading }}
        </p>
      {% endif %}
    </div>

    {%- comment -%} Grid de Posts {%- endcomment -%}
    {% if blog.articles_count > 0 %}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-{{ section.settings.columns_desktop }} gap-8 mb-10">
        {% for article in blog.articles limit: posts_to_show %}
          <div class="blog-post-card">
            {% render 'card-article',
              article: article,
              show_excerpt: show_excerpt,
              show_author: show_author,
              show_tags: show_tags,
              show_image: true
            %}
          </div>
        {% endfor %}
      </div>

      {%- comment -%} Botão Ver Todos {%- endcomment -%}
      {% if show_button and blog.url %}
        <div class="text-center">
          <a
            href="{{ blog.url }}"
            class="inline-flex items-center gap-2 px-8 py-3 bg-black text-white font-medium rounded-lg hover:bg-gray-800 transition-colors"
          >
            {{ section.settings.button_text | default: 'Ver Todos os Artigos' }}
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
      {% endif %}
    {% else %}
      {%- comment -%} Estado Vazio {%- endcomment -%}
      <div class="text-center py-12">
        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
        </svg>
        <p class="text-gray-600 text-lg">Nenhum artigo publicado ainda.</p>
      </div>
    {% endif %}

  </div>
</section>

{% schema %}
{
  "name": "Posts do Blog",
  "tag": "section",
  "class": "section-blog-posts",
  "settings": [
    {
      "type": "header",
      "content": "Conteúdo"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Título da Seção",
      "default": "Últimas do Blog"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subtítulo",
      "default": "Fique por dentro das últimas tendências e novidades da moda"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog",
      "info": "Selecione o blog de onde os posts serão exibidos"
    },
    {
      "type": "range",
      "id": "posts_to_show",
      "label": "Número de Posts",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 3,
      "info": "Quantidade de posts a exibir"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Colunas (Desktop)",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Cor de Fundo",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Configurações dos Cards"
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Mostrar Resumo",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Mostrar Autor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "Mostrar Tags",
      "default": true
    },
    {
      "type": "header",
      "content": "Botão"
    },
    {
      "type": "checkbox",
      "id": "show_button",
      "label": "Mostrar Botão 'Ver Todos'",
      "default": true
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texto do Botão",
      "default": "Ver Todos os Artigos"
    }
  ],
  "presets": [
    {
      "name": "Posts do Blog",
      "settings": {
        "heading": "Últimas do Blog",
        "subheading": "Fique por dentro das últimas tendências e novidades da moda",
        "posts_to_show": 3,
        "columns_desktop": 3,
        "show_excerpt": true,
        "show_tags": true,
        "show_button": true
      }
    }
  ]
}
{% endschema %}
