{%- comment -%}
  Se√ß√£o de Trust Badges / Benefits Bar
  Exibe benef√≠cios e garantias da loja para aumentar confian√ßa
{%- endcomment -%}

{%- liquid
  assign layout = section.settings.layout | default: 'grid'
  assign sticky = section.settings.sticky
  assign icon_color = section.settings.icon_color
  assign text_color = section.settings.text_color
  assign bg_color = section.settings.background_color
-%}

<section
  class="trust-badges-section {% if sticky %}sticky top-0 z-30{% endif %} transition-all"
  style="background-color: {{ bg_color }}; color: {{ text_color }};"
  data-trust-badges
>
  <div class="container mx-auto px-4 md:px-6 lg:px-8 py-4 md:py-5">

    {%- comment -%} Grid Layout Desktop {%- endcomment -%}
    {% if layout == 'grid' %}
      <div class="hidden md:grid grid-cols-{{ section.blocks.size }} gap-6 lg:gap-8">
        {% for block in section.blocks %}
          <div class="trust-badge-item text-center" {{ block.shopify_attributes }}>
            {% render 'trust-badge-item',
              block: block,
              icon_color: icon_color,
              text_color: text_color
            %}
          </div>
        {% endfor %}
      </div>

      {%- comment -%} Slider Mobile {%- endcomment -%}
      <div class="md:hidden">
        <div class="owl-carousel owl-theme trust-badges-carousel">
          {% for block in section.blocks %}
            <div class="trust-badge-item text-center" {{ block.shopify_attributes }}>
              {% render 'trust-badge-item',
                block: block,
                icon_color: icon_color,
                text_color: text_color
              %}
            </div>
          {% endfor %}
        </div>
      </div>

    {%- comment -%} Slider em todas as telas {%- endcomment -%}
    {% elsif layout == 'slider' %}
      <div class="owl-carousel owl-theme trust-badges-carousel">
        {% for block in section.blocks %}
          <div class="trust-badge-item text-center" {{ block.shopify_attributes }}>
            {% render 'trust-badge-item',
              block: block,
              icon_color: icon_color,
              text_color: text_color
            %}
          </div>
        {% endfor %}
      </div>

    {%- comment -%} Lista simples (sem slider) {%- endcomment -%}
    {% elsif layout == 'list' %}
      <div class="flex flex-wrap justify-center items-center gap-6 lg:gap-10">
        {% for block in section.blocks %}
          <div class="trust-badge-item flex items-center gap-3" {{ block.shopify_attributes }}>
            {% render 'trust-badge-item',
              block: block,
              icon_color: icon_color,
              text_color: text_color,
              compact: true
            %}
          </div>
        {% endfor %}
      </div>
    {% endif %}

  </div>
</section>

{%- comment -%} JavaScript para Owl Carousel {%- endcomment -%}
{% if layout == 'slider' or layout == 'grid' %}
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const carousels = document.querySelectorAll('.trust-badges-carousel');

      carousels.forEach(function(carousel) {
        $(carousel).owlCarousel({
          items: 1,
          loop: true,
          autoplay: true,
          autoplayTimeout: 4000,
          autoplayHoverPause: true,
          dots: true,
          nav: false,
          margin: 20,
          center: true,
          responsive: {
            640: {
              items: 2
            },
            1024: {
              items: {{ section.blocks.size | at_most: 4 }}
            }
          }
        });
      });
    });
  </script>
{% endif %}

<style>
  .trust-badges-carousel .owl-dots {
    margin-top: 1rem;
  }

  .trust-badges-carousel .owl-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    background: {{ text_color | default: '#000' }};
    opacity: 0.3;
    border-radius: 50%;
    margin: 0 4px;
    transition: opacity 0.3s;
  }

  .trust-badges-carousel .owl-dot.active {
    opacity: 1;
  }
</style>

{% schema %}
{
  "name": "Trust Badges",
  "tag": "section",
  "class": "section-trust-badges",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Tipo de Layout",
      "options": [
        {
          "value": "grid",
          "label": "Grid (Desktop) / Slider (Mobile)"
        },
        {
          "value": "slider",
          "label": "Slider (Todas as telas)"
        },
        {
          "value": "list",
          "label": "Lista Horizontal"
        }
      ],
      "default": "grid",
      "info": "Grid √© recomendado para melhor performance"
    },
    {
      "type": "checkbox",
      "id": "sticky",
      "label": "Fixar no Topo (Sticky)",
      "default": false,
      "info": "Mant√©m a barra vis√≠vel ao rolar a p√°gina"
    },
    {
      "type": "header",
      "content": "Cores"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Cor de Fundo",
      "default": "#f9fafb"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Cor do Texto",
      "default": "#111827"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Cor dos √çcones",
      "default": "#000000"
    }
  ],
  "blocks": [
    {
      "type": "badge",
      "name": "Badge",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "√çcone",
          "options": [
            {
              "value": "truck",
              "label": "üöö Caminh√£o (Frete)"
            },
            {
              "value": "shield",
              "label": "üõ°Ô∏è Escudo (Seguran√ßa)"
            },
            {
              "value": "refresh",
              "label": "üîÑ Refresh (Troca/Devolu√ß√£o)"
            },
            {
              "value": "credit-card",
              "label": "üí≥ Cart√£o (Pagamento)"
            },
            {
              "value": "star",
              "label": "‚≠ê Estrela (Qualidade)"
            },
            {
              "value": "check-circle",
              "label": "‚úì Check (Garantia)"
            },
            {
              "value": "lock",
              "label": "üîí Cadeado (Privacidade)"
            },
            {
              "value": "clock",
              "label": "‚è∞ Rel√≥gio (Prazo)"
            }
          ],
          "default": "truck"
        },
        {
          "type": "text",
          "id": "title",
          "label": "T√≠tulo",
          "default": "Frete Gr√°tis"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Descri√ß√£o",
          "default": "Acima de R$ 299",
          "info": "Opcional - deixe em branco para ocultar"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Trust Badges",
      "blocks": [
        {
          "type": "badge",
          "settings": {
            "icon": "truck",
            "title": "Frete Gr√°tis",
            "description": "Acima de R$ 299"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "refresh",
            "title": "Troca F√°cil",
            "description": "30 dias para trocar"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "shield",
            "title": "Compra Segura",
            "description": "100% protegida"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "credit-card",
            "title": "Parcele sem Juros",
            "description": "Em at√© 6x no cart√£o"
          }
        }
      ]
    }
  ]
}
{% endschema %}
