{%- liquid
  assign variants_available = product.variants | map: 'available'
  assign variants_id = product.variants | map: 'id'

  assign product_form_id = 'product-form-' | append: section.id

  assign shape = block.settings.swatch_shape
-%}
<div class="flex flex-wrap gap-3">
  {%- for value in option.values -%}
    {%- liquid
      assign option_disabled = true

      assign checked = false
      if option.selected_value == value
        assign checked = true
      endif

      if value.swatch.image
        assign image_url = value.swatch.image | image_url: width: 50
        assign swatch_value = 'url(' | append: image_url | append: ')'
      elsif value.swatch.color
        assign swatch_value = 'rgb(' | append: value.swatch.color.rgb | append: ')'
      else
        assign swatch_value = null
      endif
    -%}

    {%- capture input_id -%}
      {{ section.id }}-{{ option.position }}-{{ forloop.index0 -}}
    {%- endcapture -%}

    <div>
      <input
        type="radio"
        id="{{ input_id }}"
        name="{{ option.name }}"
        value="{{ value | escape }}"
        form="{{ product_form_id }}"
        class="sr-only peer"
        {% if checked %}
          checked
        {% endif %}
      >

      {% if swatch_value != null and picker_type == 'swatch' %}
        <label
          for="{{ input_id }}"
          class="swatch-label relative flex items-center justify-center w-10 h-10 cursor-pointer border border-gray-300 peer-checked:border-black peer-checked:ring-1 peer-checked:ring-offset-1 peer-checked:ring-black overflow-hidden {% if shape == 'circle' %}rounded-full{% else %}rounded{% endif %}"
          title="{{ value | escape }}"
        >
          <span
            style="background: {{ swatch_value }}; {% if value.swatch.image %}background-size: cover;{% endif %}"
            class="w-full h-full block {% if shape == 'circle' %}rounded-full{% else %}rounded-sm{% endif %}"
          ></span>
        </label>
      {% else %}
        <label
          for="{{ input_id }}"
          class="not-swatch inline-block px-3 py-1.5 min-w-[50px] text-center border border-gray-300 rounded cursor-pointer text-sm peer-checked:bg-black peer-checked:border-black peer-checked:text-white hover:border-gray-400 transition-colors"
        >
          {{ value }}
        </label>
      {% endif %}
    </div>
  {% endfor %}
</div>